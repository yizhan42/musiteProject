<?phpset_include_path('system'.PATH_SEPARATOR.'templates');require_once('Template.php');require_once('Database.php');require_once('RedirectBrowserException.php');$tmpl = new Template();$type = $_GET['type'];if ($_GET['html']=='on') {	$eol = '<br/>';} else {	$eol = "\n";}if ($type == 'getmodels') {	$dir = 'backend/model/';	$ext = '.model';	$models = glob($dir."*$ext");	foreach($models as $model) {		echo basename($model,$ext);		echo $eol;	}} elseif($type == 'pred') {	if (isset($_GET['seq'])) {		$seq = $_GET['seq'];	} elseif (isset($_GET['acc'])) {		$typeacc = explode(':',$_GET['acc'],2);		if ($typeacc[0]=='uniprot') {			$seq = file_get_contents('http://www.uniprot.org/uniprot/'.$typeacc[1].'.fasta');			if ($seq == false || $seq[0]!='>') {				$err = $typeacc[1]." was not found as an accession number.";			}		} else {			$err = $typeacc[0].' is not a supported accession type.';		}	} else {		$err = 'Please specify the protein sequence or accession number';	}		$model = $_GET['model'];	if (!isset($model)) {		$err = "Please specified a model.";	}			$sp = 0;	if (isset($_GET['sp'])) {		if (is_numeric($_GET['sp'])) {			$sp = floatval($_GET['sp']);			if ($sp<0 || $sp>1) {				$err = 'Specificity can only be a number between 0.0 to 1.0.';			}		} else {			$err = 'Specificity can only be a number between 0.0 to 1.0.';		}	}		if (isset($err)) {		echo $err;	} else {			set_include_path('backend');		require_once('execute.php');				$output = execute($seq, $model.'.model', 'backend');		$n = count($output);		for ($i=2; $i<$n; $i++) {			$strs = explode("\t",$output[$i]);			if (floatval($strs[4])>=$sp)				echo $strs[2]."\t".$strs[0]."\t".$strs[4].$eol;		}	}} else {	// display the template/service.tmpl in a new tab	$HTML = $tmpl->build('service.tmpl');	$tmpl->pageContent = $HTML;	print $tmpl->pageContent;}?>